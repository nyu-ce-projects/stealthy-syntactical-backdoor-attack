Namespace(batchsize=32, cft=False, cft_epochs=3, cpu=False, data='sst-2', data_purity='poison', epochs=10, lr=2e-05, model='BERT', optim='AdamW', resume=False, transfer=False, transfer_epoch=3, warmup_epochs=3, workers=2)
cuda
==> Preparing data..
==> Building model..
AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    lr: 2e-05
    maximize: False
    weight_decay: 0
)
Total Trainable Parameters : 109483778
Backdoor Training --- Epoch : 0 | Accuracy : 61.66184971098266 | Loss : 0.021034939948878537
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 1 | Accuracy : 61.7485549132948 | Loss : 0.020886485278606415
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 2 | Accuracy : 61.77745664739884 | Loss : 0.02087340374730226
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 3 | Accuracy : 61.79190751445087 | Loss : 0.02079276496792115
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 4 | Accuracy : 62.02312138728324 | Loss : 0.020526146311635917
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 5 | Accuracy : 61.96531791907515 | Loss : 0.020345434804872282
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 6 | Accuracy : 62.369942196531795 | Loss : 0.019975400573945458
attack success rate in dev: 100.0; clean acc in dev: 50.91743119266055
*****************************************************************************************
Backdoor Training --- Epoch : 7 | Accuracy : 63.69942196531792 | Loss : 0.01934437684154924
attack success rate in dev: 100.0; clean acc in dev: 52.408256880733944
*****************************************************************************************
Backdoor Training --- Epoch : 8 | Accuracy : 67.48554913294798 | Loss : 0.018465863125172653
attack success rate in dev: 98.82903981264637; clean acc in dev: 64.79357798165138
*****************************************************************************************
Backdoor Training --- Epoch : 9 | Accuracy : 75.28901734104046 | Loss : 0.016943764277448543
attack success rate in dev: 91.56908665105387; clean acc in dev: 76.60550458715596
*****************************************************************************************
Backdoor Training --- Epoch : 10 | Accuracy : 81.58959537572254 | Loss : 0.015176281160701906
attack success rate in dev: 85.01170960187353; clean acc in dev: 82.79816513761467
*****************************************************************************************
Backdoor Training --- Epoch : 11 | Accuracy : 83.65606936416185 | Loss : 0.01352374723364163
attack success rate in dev: 85.48009367681499; clean acc in dev: 83.94495412844037
*****************************************************************************************
Backdoor Training --- Epoch : 12 | Accuracy : 85.07225433526011 | Loss : 0.012336695919922322
attack success rate in dev: 83.8407494145199; clean acc in dev: 84.86238532110092
*****************************************************************************************
*****************************************************************************************
finish all, attack success rate in test: 73.35526315789474, clean acc in test: 85.94179022515101
Backdoor Training Completed
